<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Simulado Anatomia P1</title>
<style>
  :root{
    --bg:#0f172a; --card:#0b1225; --muted:#94a3b8; --text:#e2e8f0;
    --primary:#22d3ee; --primary-2:#06b6d4; --accent:#a78bfa; --ok:#34d399; --warn:#f59e0b; --err:#f43f5e;
  }
  *{box-sizing:border-box}
  html,body{
    margin:0; padding:0; background:linear-gradient(180deg,#0b1021,#0f172a);
    color:var(--text); font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial
  }
  .shell{max-width:980px; margin:40px auto; padding:0 16px;}
  .hero{
    position:relative; border-radius:18px; overflow:hidden; min-height:180px; background:#0b1021;
    display:grid; align-items:end; padding:24px;
    box-shadow:0 20px 60px rgba(0,0,0,.25), inset 0 0 120px rgba(34,211,238,.08);
    background:
      radial-gradient(1000px 380px at 20% 20%, rgba(34,211,238,.25), transparent 60%),
      radial-gradient(1000px 380px at 80% 10%, rgba(167,139,250,.2), transparent 55%),
      linear-gradient(180deg,#0b1021,#0b1021);
    background-size:cover; background-position:center;
  }
  .hero::after{content:""; position:absolute; inset:0; background:linear-gradient(180deg,rgba(15,23,42,.1), rgba(15,23,42,.8))}
  .hero>*{position:relative; z-index:2}
  .title{font-size:clamp(22px,3.4vw,36px); font-weight:800; letter-spacing:.2px}
  .subtitle{color:var(--muted)}
  .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:14px}

  /* bot√µes */
  .btn,.ghost{
    border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.04); color:var(--text);
    padding:10px 14px; border-radius:12px; cursor:pointer; transition:.2s transform ease,.25s background,.25s box-shadow;
    font-weight:700; letter-spacing:.2px; backdrop-filter: blur(6px);
  }
  .btn.primary{
    background:linear-gradient(180deg,var(--primary),var(--primary-2));
    color:#001017; border:none;
    box-shadow:0 12px 30px rgba(6,182,212,.35);
  }
  .btn.big{ font-size:18px; padding:14px 20px; border-radius:14px }
  .btn:hover,.ghost:hover{ transform:translateY(-1px); box-shadow:0 8px 28px rgba(2,132,199,.25) }

  .card{
    margin-top:22px; background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:18px;
    box-shadow:0 12px 36px rgba(0,0,0,.25)
  }
  .grid2{ display:grid; gap:14px; grid-template-columns:1fr }
  @media(min-width:860px){ .grid2{ grid-template-columns:2fr 1fr } }

  .progress{ height:10px; background:rgba(255,255,255,.08); border-radius:999px; overflow:hidden }
  .bar{ height:100%; width:0%; background:linear-gradient(90deg,var(--primary),var(--accent)); transition:width .25s ease }
  .meta{ display:flex; justify-content:space-between; align-items:center; color:var(--muted); font-size:14px; margin-top:8px }

  .q{ display:grid; gap:12px }
  .q h3{ margin:0 0 6px; font-size:20px }
  .opt{
    display:block; padding:12px; border:1px solid rgba(255,255,255,.12); border-radius:12px; cursor:pointer;
    background:rgba(255,255,255,.02); transition:.2s
  }
  .opt:hover{ background:rgba(255,255,255,.06) }
  .opt input{ margin-right:10px }

  .controls{ display:flex; gap:10px; margin-top:10px; flex-wrap:wrap }
  .pill{ padding:6px 10px; border-radius:999px; font-size:12px; border:1px solid rgba(255,255,255,.12); color:var(--muted)}
  .hidden{ display:none!important }

  .result{ display:grid; gap:12px }
  .score{
    display:flex; align-items:center; gap:12px; padding:14px; border-radius:14px;
    background:rgba(20,255,200,.07); border:1px solid rgba(34,211,238,.25)
  }
  .score b{ font-size:18px }
  .bad{ background:rgba(255,100,100,.07); border-color:rgba(244,63,94,.3) }
  .ok{ background:rgba(0,255,171,.07); border-color:rgba(52,211,153,.35) }

  .kbd{ font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace; background:#111827; color:#e5e7eb; padding:2px 6px; border-radius:6px; border:1px solid #374151 }
  .flex{ display:flex; gap:10px; align-items:center; flex-wrap:wrap }
  .right{ margin-left:auto }
  canvas{ width:100%; height:220px; background:rgba(255,255,255,.03); border-radius:12px; border:1px solid rgba(255,255,255,.08)}
</style>
</head>
<body>
  <div class="shell">
    <div class="hero">
      <div>
        <div class="title">Simulado Anatomia P1</div>
        <div class="subtitle">feito por Thais Azevedo</div>
        <div class="row">
          <!-- Bot√£o Iniciar mais evidente -->
          <button class="btn primary big" id="btnStart">‚ñ∂Ô∏è Iniciar simulado</button>
        </div>
      </div>
    </div>

    <div class="grid2">
      <div class="card">
        <div class="progress"><div class="bar" id="bar"></div></div>
        <div class="meta">
          <div id="metaLeft">Aguardando in√≠cio‚Ä¶</div>
          <div class="flex">
            <span class="pill" id="pillTimer">‚è±Ô∏è 00:00</span>
            <span class="pill" id="pillIndex">0/0</span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="result" id="panelStats">
          <div class="score" id="scoreBox"><b>Sem tentativa ainda.</b> Inicie o simulado para ver seus resultados aqui.</div>
          <div>Hist√≥rico de desempenho:</div>
          <canvas id="chart"></canvas>
          <div class="flex">
            <button class="btn" id="btnDownload">üíæ Baixar relat√≥rio</button>
            <button class="ghost" id="btnResetStats">üßπ Limpar hist√≥rico</button>
          </div>
        </div>
      </div>
    </div>

    <div class="card" id="panelQuiz">
      <div class="q" id="qBox">
        <h3>Pronto para come√ßar!</h3>
        <div>Clique em <b>Iniciar simulado</b> e responda √†s quest√µes. Ative <span class="kbd">Mostrar justificativa</span> se quiser ver dicas/resumos durante o estudo.</div>
      </div>
      <div class="controls">
        <button class="btn" id="btnPrev">‚¨ÖÔ∏è Anterior</button>
        <button class="btn" id="btnNext">Pr√≥xima ‚û°Ô∏è</button>
        <button class="btn" id="btnReview">üîç Revisar quest√£o</button>
        <button class="btn" id="btnFinish">üèÅ Finalizar</button>
        <div class="right"></div>
        <label class="flex" style="gap:6px"><input type="checkbox" id="shuffle"> Embaralhar quest√µes</label>
        <label class="flex" style="gap:6px"><input type="checkbox" id="toggleJust"> Mostrar justificativa</label>
      </div>
    </div>
  </div>

<script>
/* ============================================================
   QUIZ DATA ‚Äì 52 quest√µes (respostas zero-based: 0=a,1=b,2=c,3=d)
   ============================================================ */
const quizData = [
  {type:"mcq",id:1,question:"Qual √© a principal fun√ß√£o do sistema digest√≥rio?",options:["a) Produzir horm√¥nios para o crescimento.","b) Realizar a troca gasosa para a respira√ß√£o.","c) Processar e digerir alimentos para absorver nutrientes, √°gua e eletr√≥litos.","d) Filtrar o sangue e remover res√≠duos metab√≥licos."],answer:2,justification:"O sistema digest√≥rio processa o alimento e permite absor√ß√£o de nutrientes, √°gua e eletr√≥litos."},
  {type:"mcq",id:2,question:"O que √© a faringe e qual a sua principal fun√ß√£o?",options:["a) Um √≥rg√£o do sistema respirat√≥rio cuja principal fun√ß√£o √© a produ√ß√£o de som.","b) Uma gl√¢ndula respons√°vel pela produ√ß√£o de saliva.","c) Uma por√ß√£o do es√¥fago que armazena alimento.","d) Um tubo fibromuscular comum aos sistemas digest√≥rio e respirat√≥rio, que conduz alimento da boca ao es√¥fago e ar da cavidade nasal √† laringe."],answer:3,justification:"A faringe √© via comum de ar e alimento, conduzindo-os √†s vias adequadas."},
  {type:"mcq",id:3,question:"Quais s√£o as duas divis√µes da faringe, e por qual estrutura elas s√£o separadas?",options:["a) Es√¥fago e Laringe, separadas pelo palato duro.","b) Nasofaringe e Laringofaringe, separadas pelo arco palatofar√≠ngeo.","c) Nasofaringe e Orofaringe, separadas pelo palato mole.","d) Orofaringe e Es√¥fago, separadas pela epiglote."],answer:2,justification:"Nasofaringe e Orofaringe separadas pelo palato mole."},
  {type:"mcq",id:4,question:"Durante a degluti√ß√£o, o que acontece com o palato mole?",options:["a) Ele se retrai, abrindo a passagem para a laringe.","b) Ele se move para baixo, bloqueando o es√¥fago.","c) Ele se eleva e se estende para tr√°s (dorsal e caudalmente), isolando a nasofaringe da orofaringe.","d) Ele permanece im√≥vel, n√£o interferindo na passagem."],answer:2,justification:"Eleva-se e isola a nasofaringe para evitar refluxo nasal."},
  {type:"mcq",id:5,question:"Como a laringe e a epiglote agem durante a degluti√ß√£o para evitar que o alimento entre na traqueia?",options:["a) A laringe se eleva e a epiglote se retrai, mantendo a traqueia aberta.","b) A laringe se move para baixo e a epiglote fica im√≥vel.","c) A laringe se eleva e a epiglote se inclina caudalmente, fechando a abertura da laringe e desviando o alimento para o es√¥fago.","d) Ambas permanecem abertas, e o controle √© feito apenas pelo reflexo da tosse."],answer:2,justification:"Eleva√ß√£o lar√≠ngea + basculamento da epiglote protegem a via a√©rea."},
  {type:"mcq",id:6,question:"Qual a diferen√ßa de fun√ß√£o entre a nasofaringe e a orofaringe em rela√ß√£o √† passagem de ar e alimento?",options:["a) A nasofaringe s√≥ conduz ar e a orofaringe s√≥ conduz alimento.","b) A nasofaringe s√≥ √© passagem de ar; a orofaringe √© passagem comum de ar e alimento.","c) A nasofaringe √© passagem comum e a orofaringe √© apenas de ar.","d) Ambas s√£o apenas de alimento."],answer:1,justification:"Nasofaringe: ar. Orofaringe: ar e alimento."},
  {type:"mcq",id:7,question:"Que nervo controla a fase involunt√°ria da degluti√ß√£o?",options:["a) Nervo Trig√™meo (V).","b) Nervo Facial (VII).","c) Nervo Hipoglosso (XII).","d) Nervo Glossofar√≠ngeo (IX) e Vago (X)."],answer:3,justification:"IX e X coordenam reflexos de degluti√ß√£o."},
  {type:"mcq",id:8,question:"Em qual esp√©cie o palato mole √© estendido, impedindo a respira√ß√£o pela boca?",options:["a) Su√≠nos.","b) Bovinos.","c) Equinos.","d) Caninos."],answer:2,justification:"Equinos respiram obrigatoriamente pelo nariz."},
  {type:"mcq",id:9,question:"Quais s√£o as duas articula√ß√µes que permitem a movimenta√ß√£o das cartilagens da laringe?",options:["a) Articula√ß√£o cricotire√≥idea e Articula√ß√£o hioepigl√≥tica.","b) Articula√ß√£o cricoariten√≥idea e Articula√ß√£o aritenocorniculada.","c) Articula√ß√£o cricotire√≥idea e Articula√ß√£o cricoariten√≥idea.","d) Articula√ß√£o cricofar√≠ngea e Articula√ß√£o tireofar√≠ngea."],answer:2,justification:"Cricotire√≥idea e cricoariten√≥idea."},
  {type:"mcq",id:10,question:"Descreva a fun√ß√£o do es√¥fago.",options:["a) Produzir enzimas digestivas.","b) Transportar o alimento da faringe para o est√¥mago por meio de movimentos perist√°lticos.","c) Absorver a maior parte dos nutrientes.","d) Armazenar e umedecer o bolo alimentar."],answer:1,justification:"Fun√ß√£o de condu√ß√£o por peristalse."},
  {type:"mcq",id:11,question:"O que s√£o movimentos perist√°lticos e como eles funcionam no es√¥fago?",options:["a) Movimentos de mistura que quebram o alimento em part√≠culas menores.","b) Movimentos de relaxamento do est√¥mago para acomodar o alimento.","c) Contra√ß√µes musculares coordenadas em ondas que impulsionam o alimento em dire√ß√£o ao est√¥mago.","d) Relaxamento da musculatura lisa do es√¥fago."],answer:2,justification:"Ondas de contra√ß√£o coordenadas empurram o bolo."},
  {type:"mcq",id:12,question:"Quais s√£o as tr√™s por√ß√µes do es√¥fago?",options:["a) Por√ß√£o far√≠ngea, Por√ß√£o g√°strica e Por√ß√£o pil√≥rica.","b) Por√ß√£o cervical, Por√ß√£o tor√°cica e Por√ß√£o abdominal.","c) Por√ß√£o anterior, Por√ß√£o m√©dia e Por√ß√£o posterior.","d) Por√ß√£o esof√°gica, Por√ß√£o jejunal e Por√ß√£o ileal."],answer:1,justification:"Cervical, tor√°cica e abdominal."},
  {type:"mcq",id:13,question:"O que acontece com as fibras musculares do es√¥fago quando o alimento chega?",options:["a) Elas relaxam de uma vez, permitindo a queda livre do alimento.","b) Elas se contraem em ondas perist√°lticas, impulsionando o bolo alimentar.","c) Elas se contraem apenas na por√ß√£o abdominal.","d) Elas produzem muco para lubrificar o alimento."],answer:1,justification:"Contra√ß√µes em onda impulsionam o bolo."},
  {type:"mcq",id:14,question:"Qual √© a fun√ß√£o da segunda onda perist√°ltica no es√¥fago?",options:["a) Iniciar o processo de digest√£o qu√≠mica.","b) Limpar o es√¥fago de qualquer res√≠duo alimentar que n√£o tenha sido removido pela primeira onda.","c) Abrir o esf√≠ncter pil√≥rico.","d) Promover a mistura do alimento com enzimas."],answer:1,justification:"A segunda onda ‚Äúvarre‚Äù res√≠duos restantes."},
  {type:"mcq",id:15,question:"O que acontece com o es√¥fago na regi√£o do hiato esof√°gico?",options:["a) Ele se torna mais largo e dobra-se.","b) Ele libera enzimas digestivas.","c) Ele penetra no abd√¥men (cavidade abdominal), atravessando o m√∫sculo diafragma (hiato esof√°gico).","d) Ele se conecta diretamente com o intestino delgado."],answer:2,justification:"Atravessa o diafragma pelo hiato esof√°gico."},
  {type:"mcq",id:16,question:"O que √© o est√¥mago e qual sua fun√ß√£o principal?",options:["a) √â um √≥rg√£o glandular que filtra toxinas.","b) √â uma dilata√ß√£o do tubo digest√≥rio que armazena o alimento e inicia a digest√£o de prote√≠nas.","c) √â um tubo muscular que absorve √°gua e eletr√≥litos.","d) √â o local onde ocorre a digest√£o de gorduras."],answer:1,justification:"Armazena e inicia digest√£o proteica."},
  {type:"mcq",id:17,question:"Que subst√¢ncias, al√©m das enzimas, o est√¥mago produz para a digest√£o?",options:["a) Bile e Lipase.","b) Horm√¥nios (Insulina e Glucagon).","c) √Åcido clor√≠drico (HCl) e Fator Intr√≠nseco.","d) Amilase salivar e Muco."],answer:2,justification:"HCl e fator intr√≠nseco."},
  {type:"mcq",id:18,question:"Qual √© a principal forma de digest√£o nos animais com est√¥mago simples?",options:["a) Fermenta√ß√£o microbiana.","b) Digest√£o qu√≠mica e mec√¢nica (movimentos de mistura).","c) A√ß√£o de bact√©rias simbi√≥ticas.","d) Absor√ß√£o direta de nutrientes."],answer:1,justification:"Qu√≠mica (HCl/enzimas) e mec√¢nica (mistura)."},
  {type:"mcq",id:19,question:"Quais s√£o as quatro regi√µes em que o est√¥mago simples √© dividido?",options:["a) C√°rdia, Esf√≠ncter, Fundo e Piloro.","b) Es√¥fago, Fundo, Corpo e Intestino.","c) C√°rdia, Fundo, Corpo e Por√ß√£o Pil√≥rica.","d) R√∫men, Ret√≠culo, Omaso e Abomaso."],answer:2,justification:"C√°rdia, Fundo, Corpo e pil√≥rica."},
  {type:"mcq",id:20,question:"Por que o est√¥mago tem uma grande capacidade de distens√£o?",options:["a) Devido √† presen√ßa de micro-organismos que produzem g√°s.","b) Por ser um √≥rg√£o extremamente r√≠gido.","c) Devido √† presen√ßa de pregas (rugas g√°stricas) na mucosa e relaxamento das camadas musculares.","d) Devido ao seu constante enchimento por l√≠quidos."],answer:2,justification:"Rugas g√°stricas e complac√™ncia muscular."},
  {type:"mcq",id:21,question:"Qual √© o formato do est√¥mago simples e quais s√£o suas duas curvaturas?",options:["a) Formato de \"U\"; Curvatura ventral e Curvatura dorsal.","b) Formato de \"S\"; Curvatura anterior e Curvatura posterior.","c) Formato de \"J\"; Curvatura menor (medial/cranial) e Curvatura maior (lateral/caudal).","d) Formato esf√©rico; Curvatura superior e Curvatura inferior."],answer:2,justification:"Formato de J; curvatura menor e maior."},
  {type:"mcq",id:22,question:"D√™ exemplos de animais que possuem est√¥mago simples.",options:["a) Bovinos e Caprinos.","b) Caninos, Felinos, Su√≠nos e Equinos.","c) Ovinos e Camelos.","d) Ruminantes e Aves."],answer:1,justification:"C√£es, gatos, su√≠nos e equinos."},
  {type:"mcq",id:23,question:"Que caracter√≠stica anat√¥mica do est√¥mago explica a facilidade de c√£es e gatos em regurgitar?",options:["a) A grande acidez do suco g√°strico.","b) A musculatura lisa do piloro.","c) O desenvolvimento fraco da camada muscular na regi√£o da C√°rdia.","d) O formato alongado do corpo do est√¥mago."],answer:2,justification:"C√°rdia menos desenvolvida favorece refluxo."},
  {type:"mcq",id:24,question:"Que estrutura exclusiva o est√¥mago dos su√≠nos possui para aumentar ainda mais seu volume?",options:["a) A gl√¢ndula pil√≥rica.","b) O divert√≠culo g√°strico.","c) O esf√≠ncter esof√°gico forte.","d) O divert√≠culo g√°strico (ou cego)."],answer:3,justification:"Su√≠nos t√™m divert√≠culo g√°strico."},
  {type:"mcq",id:25,question:"Qual a caracter√≠stica anat√¥mica do est√¥mago de equinos que impede o v√¥mito?",options:["a) Esf√≠ncter pil√≥rico fraco.","b) Grande volume do intestino.","c) Esf√≠ncter esof√°gico (C√°rdia) forte e √¢ngulo obl√≠quo de entrada do es√¥fago.","d) Est√¥mago muito pequeno."],answer:2,justification:"C√°rdia forte + √¢ngulo obl√≠quo impedem refluxo."},
  {type:"mcq",id:26,question:"Quais s√£o as regi√µes da mucosa g√°strica e o que cada uma produz?",options:["a) C√°rdia (apenas enzimas) e Fundo (apenas muco).","b) C√°rdia (Muco), Fundo e Corpo (HCl, Pepsinog√™nio, Fator Intr√≠nseco) e Pil√≥rica (Muco, Gastrina).","c) Corpo (Somente √°gua) e Pil√≥rica (Bile).","d) R√∫men (AGVs) e Ret√≠culo (Muco)."],answer:1,justification:"C√°rdia: muco; Fundo/Corpo: HCl/pepsinog√™nio/fator; Pil√≥rica: muco/gastrina."},
  {type:"mcq",id:27,question:"Qual a fun√ß√£o do suco g√°strico e do muco?",options:["a) Suco g√°strico umedece o alimento e o muco inicia digest√£o de carboidratos.","b) Suco g√°strico (HCl) destr√≥i microrganismos e desnatura prote√≠nas; muco protege a mucosa.","c) Suco g√°strico emulsifica gorduras e muco absorve √°gua.","d) Suco g√°strico neutraliza o pH e muco √© o principal agente de digest√£o."],answer:1,justification:"HCl antimicrobiano e desnaturante; muco protege epit√©lio."},
  {type:"mcq",id:28,question:"Quais s√£o as quatro estruturas que comp√µem o est√¥mago dos ruminantes?",options:["a) Es√¥fago, P√¢ncreas, Ba√ßo e F√≠gado.","b) C√°rdia, Fundo, Corpo e Piloro.","c) R√∫men, Ret√≠culo, Omaso e Abomaso.","d) Intestino Delgado, Ceco, C√≥lon e Reto."],answer:2,justification:"R√∫men, ret√≠culo, omaso e abomaso."},
  {type:"mcq",id:29,question:"D√™ exemplos de animais que possuem est√¥mago composto.",options:["a) C√£es e Gatos.","b) Cavalos e Porcos.","c) Bovinos, Ovinos, Caprinos e outros Ruminantes.","d) Aves e R√©pteis."],answer:2,justification:"Ruminantes t√™m est√¥mago composto."},
  {type:"mcq",id:30,question:"Como se desenvolve o est√¥mago composto de um bezerro?",options:["a) Todas as c√¢maras iguais desde o nascimento.","b) No nascimento, abomaso √© o maior/mais funcional; com dieta s√≥lida, r√∫men e ret√≠culo crescem e assumem fun√ß√£o fermentativa.","c) O omaso se desenvolve primeiro.","d) O r√∫men j√° √© grande no nascimento e o abomaso cresce depois."],answer:1,justification:"Abomaso prevalente ao nascer; r√∫men/ret√≠culo expandem com o desmame."},
  {type:"mcq",id:31,question:"Explique o processo de simbiose que ocorre no r√∫men e ret√≠culo.",options:["a) C√©lulas do r√∫men produzem enzimas para celulose.","b) Hospedeiro absorve √°gua e microrganismos produzem muco.","c) R√∫men e ret√≠culo s√£o reservat√≥rios est√©reis.","d) Microrganismos fermentam carboidratos complexos em AGVs, absorvidos como energia principal."],answer:3,justification:"Fermenta√ß√£o microbiana gera AGVs (energia)."},
  {type:"mcq",id:32,question:"O que √© o omaso e qual sua fun√ß√£o?",options:["a) Est√¥mago glandular da digest√£o qu√≠mica.","b) C√¢mara principal de fermenta√ß√£o e produ√ß√£o de g√°s.","c) Terceiro compartimento em ‚Äúfolhas de livro‚Äù, que absorve √°gua e filtra part√≠culas finas.","d) C√¢mara de separa√ß√£o de part√≠culas grosseiras e finas."],answer:2,justification:"Omaso absorve √°gua e seleciona part√≠culas."},
  {type:"mcq",id:33,question:"Qual compartimento do est√¥mago composto √© mais semelhante ao est√¥mago simples?",options:["a) R√∫men.","b) Ret√≠culo.","c) Omaso.","d) Abomaso (verdadeiro, secreta √°cido e enzimas)."],answer:3,justification:"Abomaso equivale ao est√¥mago simples."},
  {type:"mcq",id:34,question:"Onde o abomaso est√° localizado em rela√ß√£o ao r√∫men?",options:["a) Cranialmente ao r√∫men, na regi√£o dorsal.","b) Dorsalmente ao r√∫men, √† esquerda.","c) Ventral e caudalmente ao r√∫men (principalmente √† direita da linha m√©dia).","d) Lateralmente ao r√∫men."],answer:2,justification:"Posi√ß√£o ventro-caudal, majoritariamente √† direita."},
  {type:"mcq",id:35,question:"Qual a fun√ß√£o do ret√≠culo na digest√£o dos ruminantes?",options:["a) Secretar HCl.","b) Absorver a maior parte dos AGVs.","c) Capturar materiais pesados/estranhos e atuar na rumina√ß√£o (separa√ß√£o/regurgita√ß√£o).","d) Principal local de absor√ß√£o de √°gua."],answer:2,justification:"Ret√©m corpos estranhos e participa da sele√ß√£o/regurgita√ß√£o."},
  {type:"mcq",id:36,question:"Descreva a estrutura interna da mucosa do ret√≠culo.",options:["a) Lisa e coberta por pequenas vilosidades.","b) Pregas g√°stricas longitudinais.","c) Padr√£o de ‚Äúfavos de mel‚Äù (hex√°gonos).","d) Numerosas folhas ou l√¢minas."],answer:2,justification:"Aspecto em colmeia √© t√≠pico do ret√≠culo."},
  {type:"mcq",id:37,question:"O que √© a goteira esof√°gica e qual sua fun√ß√£o na amamenta√ß√£o dos filhotes ruminantes?",options:["a) Ducto que conecta r√∫men a omaso.","b) Estrutura que secreta enzimas do leite.","c) Reflexo que desvia o leite do es√¥fago direto ao abomaso, evitando fermenta√ß√£o no r√∫men.","d) V√°lvula de sa√≠da de gases do r√∫men."],answer:2,justification:"Fecha como ‚Äúponte‚Äù e envia leite ao abomaso."},
  {type:"mcq",id:38,question:"Quais s√£o as duas por√ß√µes em que o intestino √© dividido e qual a fun√ß√£o de cada uma?",options:["a) Jejuno e √çleo: absorver √°gua.","b) Intestino Delgado (digest√£o/absor√ß√£o de nutrientes) e Intestino Grosso (absor√ß√£o de √°gua/eletr√≥litos e fermenta√ß√£o em herb√≠voros).","c) Est√¥mago e Intestino: armazenar/digerir.","d) Ceco e C√≥lon: apenas expelir fezes."],answer:1,justification:"Delgado absorve nutrientes; grosso absorve √°gua e fermenta."},
  {type:"mcq",id:39,question:"Por que o intestino dos carn√≠voros √© mais curto do que o dos herb√≠voros?",options:["a) Porque os carn√≠voros comem menos.","b) Porque requer longa fermenta√ß√£o microbiana.","c) Dieta carn√≠vora √© digerida mais rapidamente que celulose dos herb√≠voros.","d) Carn√≠voros n√£o absorvem nutrientes, apenas √°gua."],answer:2,justification:"Prote√≠nas e gorduras s√£o digeridas mais r√°pido que celulose."},
  {type:"mcq",id:40,question:"Qual por√ß√£o do intestino √© respons√°vel pela digest√£o fermentativa nos equinos?",options:["a) Intestino Delgado.","b) Intestino Grosso (Ceco e C√≥lon Maior).","c) Abomaso.","d) Duodeno."],answer:1,justification:"Equinos s√£o fermentadores de intestino grosso."},
  {type:"mcq",id:41,question:"Quais s√£o as tr√™s partes do intestino delgado?",options:["a) Es√¥fago, Est√¥mago e Duodeno.","b) Duodeno, Jejuno e √çleo.","c) Ceco, C√≥lon e Reto.","d) C√°rdia, Fundo e Piloro."],answer:1,justification:"Delgado: duodeno, jejuno, √≠leo."},
  {type:"mcq",id:42,question:"Qual a fun√ß√£o do duodeno?",options:["a) Absorver vitamina B12 e sais biliares.","b) Receber o quimo, neutralizar acidez e receber bile/pancre√°tico para iniciar digest√£o qu√≠mica.","c) Armazenar fezes.","d) Absorver a maior parte da √°gua."],answer:1,justification:"Neutraliza√ß√£o + chegada de bile e suco pancre√°tico."},
  {type:"mcq",id:43,question:"Qual a maior por√ß√£o do intestino delgado?",options:["a) Duodeno.","b) √çleo.","c) Jejuno (principal absor√ß√£o de amino√°cidos, monossacar√≠deos e √°cidos graxos).","d) Ceco."],answer:2,justification:"Jejuno √© extenso e muito absortivo."},
  {type:"mcq",id:44,question:"O que s√£o os linfonodos jejunais (mesent√©rio) e qual a sua fun√ß√£o?",options:["a) Estruturas respons√°veis pela produ√ß√£o de enzimas digestivas.","b) G√¢nglios linf√°ticos no mesent√©rio que filtram linfa do intestino para prote√ß√£o imunol√≥gica.","c) Local de absor√ß√£o da bile.","d) C√©lulas respons√°veis pela peristalse."],answer:1,justification:"Vigil√¢ncia imunol√≥gica do trato intestinal."},
  {type:"mcq",id:45,question:"Qual a fun√ß√£o das gl√¢ndulas salivares?",options:["a) Produzir suco g√°strico.","b) Produzir saliva (umedecer, lubrificar e, em su√≠nos, iniciar digest√£o de carboidratos).","c) Secretar bile para o duodeno.","d) Absorver AGVs."],answer:1,justification:"Saliva facilita degluti√ß√£o e pode ter amilase (su√≠nos)."},
  {type:"mcq",id:46,question:"Qual a fun√ß√£o da bile e onde ela √© liberada?",options:["a) Digere prote√≠nas e √© liberada no est√¥mago.","b) Neutraliza o pH do est√¥mago e √© liberada no r√∫men.","c) Emulsifica gorduras e √© liberada no duodeno.","d) Absorve √°gua e √© liberada no intestino grosso."],answer:2,justification:"Emulsifica lip√≠dios no duodeno."},
  {type:"mcq",id:47,question:"Qual o √≥rg√£o respons√°vel por produzir o suco pancre√°tico e onde ele √© liberado?",options:["a) F√≠gado, liberado no est√¥mago.","b) Ves√≠cula biliar, liberada no intestino grosso.","c) P√¢ncreas, liberado no duodeno (enzimas e bicarbonato).","d) Ba√ßo, liberado no jejuno."],answer:2,justification:"P√¢ncreas ‚Üí duodeno; amilase, lipase, proteases e bicarbonato."},
  {type:"mcq",id:48,question:"Que esp√©cie n√£o possui ves√≠cula biliar?",options:["a) Su√≠nos.","b) Gatos.","c) Equinos.","d) Bovinos."],answer:2,justification:"Equinos n√£o t√™m ves√≠cula biliar."},
  {type:"mcq",id:49,question:"Qual a fun√ß√£o dos dentes incisivos, caninos, pr√©-molares e molares?",options:["a) Todos trituram.","b) Incisivos (apreens√£o/corte), Caninos (perfura√ß√£o/segurar), Pr√©-molares e Molares (triturar/moer).","c) Incisivos (moer) e Molares (cortar).","d) Caninos (apreens√£o) e Incisivos (tritura√ß√£o)."],answer:1,justification:"Fun√ß√µes espec√≠ficas por tipo dent√°rio."},
  {type:"mcq",id:50,question:"Qual a principal caracter√≠stica da f√≥rmula dent√°ria de ruminantes?",options:["a) Aus√™ncia de caninos e presen√ßa de incisivos superiores.","b) Dentes iguais aos carn√≠voros.","c) Aus√™ncia de incisivos e caninos superiores, substitu√≠dos pelo pulvino dent√°rio (placa dura).","d) Molares/pr√©-molares muito reduzidos."],answer:2,justification:"Pulvino dent√°rio substitui incisivos/caninos superiores."},
  {type:"mcq",id:51,question:"O que √© o pulvino dent√°rio?",options:["a) O primeiro molar do equino.","b) Placa dura fibrosa que substitui incisivos/caninos superiores nos ruminantes, ajudando na preens√£o da forragem.","c) Um dente canino muito grande.","d) Crescimento √≥sseo na mand√≠bula."],answer:1,justification:"Estrutura fibrosa dura que substitui dentes anteriores superiores."},
  {type:"mcq",id:52,question:"Quais s√£o as tr√™s por√ß√µes do aparelho respirat√≥rio e quais estruturas comp√µem a por√ß√£o condutora?",options:["a) Pulm√£o, Br√¥nquios e Bronqu√≠olos; condutora: Alv√©olos.","b) Por√ß√£o condutora, Por√ß√£o de transi√ß√£o e Por√ß√£o respirat√≥ria; condutora: Narinas, Fossas Nasais, Faringe, Laringe, Traqueia, Br√¥nquios e Bronqu√≠olos.","c) Superior, M√©dia e Inferior; condutora: Pulm√µes.","d) Nariz, Laringe e Pulm√£o; condutora: Faringe e Es√¥fago."],answer:1,justification:"Condutora = vias que conduzem o ar at√© a por√ß√£o respirat√≥ria."}
];

/* ============================================================
   ESTADO / ELEMENTOS
   ============================================================ */
const els = {
  btnStart: document.getElementById('btnStart'),
  bar: document.getElementById('bar'),
  metaLeft: document.getElementById('metaLeft'),
  pillTimer: document.getElementById('pillTimer'),
  pillIndex: document.getElementById('pillIndex'),
  qBox: document.getElementById('qBox'),
  btnPrev: document.getElementById('btnPrev'),
  btnNext: document.getElementById('btnNext'),
  btnReview: document.getElementById('btnReview'),
  btnFinish: document.getElementById('btnFinish'),
  shuffle: document.getElementById('shuffle'),
  toggleJust: document.getElementById('toggleJust'),
  scoreBox: document.getElementById('scoreBox'),
  chart: document.getElementById('chart'),
  btnDownload: document.getElementById('btnDownload'),
  btnResetStats: document.getElementById('btnResetStats')
};

let state = { started:false, idx:0, order:[], answers:{}, timerHandle:null, secs:0 };

/* ============================================================
   FUN√á√ïES DE UI / L√ìGICA
   ============================================================ */
function fmtTime(s){ const m=Math.floor(s/60), ss=s%60; return `${String(m).padStart(2,'0')}:${String(ss).padStart(2,'0')}`; }
function setProgress(){
  const total=quizData.length, cur=Math.min(state.idx+1,total);
  els.pillIndex.textContent = `${cur}/${total}`;
  els.bar.style.width = `${(cur/total*100).toFixed(1)}%`;
  els.metaLeft.textContent = state.started ? "Respondendo‚Ä¶" : "Aguardando in√≠cio‚Ä¶";
}
function tick(){ state.secs++; els.pillTimer.textContent = `‚è±Ô∏è ${fmtTime(state.secs)}`; }
function startTimer(){ stopTimer(); state.secs=0; els.pillTimer.textContent="‚è±Ô∏è 00:00"; state.timerHandle=setInterval(tick,1000); }
function stopTimer(){ if(state.timerHandle){ clearInterval(state.timerHandle); state.timerHandle=null; } }

function renderQuestion(){
  const q = quizData[state.order[state.idx]];
  let html = `<h3>${state.idx+1}. ${q.question}</h3>`;
  if(q.type==='mcq'){
    q.options.forEach((op,i)=>{
      const key=`q_${q.id}`, checked = state.answers[key]===i ? 'checked':'';
      html += `<label class="opt"><input type="radio" name="${key}" value="${i}" ${checked}> ${op}</label>`;
    });
  } else {
    const key=`q_${q.id}`, val=(state.answers[key]??'');
    html += `<textarea id="ta_${q.id}" placeholder="Digite sua resposta..." rows="4">${val||''}</textarea>`;
  }
  if(els.toggleJust.checked && q.justification){
    html += `<div class="pill" style="margin-top:6px; border-color:rgba(167,139,250,.35); color:#c7d2fe">üí° Justificativa: ${q.justification}</div>`;
  }
  els.qBox.innerHTML = html;

  if(q.type==='mcq'){
    els.qBox.querySelectorAll('input[type=radio]').forEach(r=>{
      r.addEventListener('change', e=>{ state.answers[`q_${q.id}`]=Number(e.target.value); });
    });
  } else {
    const t=document.getElementById(`ta_${q.id}`);
    t.addEventListener('input', e=>{ state.answers[`q_${q.id}`]=e.target.value.trim(); });
  }
  setProgress();
}

function next(){ if(state.idx<quizData.length-1){ state.idx++; renderQuestion(); } }
function prev(){ if(state.idx>0){ state.idx--; renderQuestion(); } }
function review(){
  const q=quizData[state.order[state.idx]], key=`q_${q.id}`;
  let msg='';
  if(q.type==='mcq'){
    const sel=state.answers[key];
    msg += sel==null ? 'Voc√™ ainda n√£o marcou nenhuma op√ß√£o.' : `Voc√™ marcou: ${q.options[sel]}`;
    if(q.answer!=null){ msg += `\nGabarito: ${q.options[q.answer]}`; }
  } else {
    msg += `Sua resposta:\n${state.answers[key] || '(em branco)'}`;
  }
  alert(msg);
}

function finish(){
  stopTimer();
  let correct=0, totalObj=0;
  quizData.forEach(q=>{
    if(q.type==='mcq'){
      totalObj++;
      const sel=state.answers[`q_${q.id}`];
      if(typeof sel==='number' && sel===q.answer) correct++;
    }
  });
  const pct = totalObj ? Math.round(correct/totalObj*100) : 0;
  const cls = pct>=70 ? 'score ok' : (pct>=50 ? 'score' : 'score bad');
  els.scoreBox.className = cls;
  els.scoreBox.innerHTML = `<b>Resultado:</b> ${correct}/${totalObj} acertos (${pct}%) ‚Ä¢ Tempo: ${fmtTime(state.secs)}`;
  const hist = JSON.parse(localStorage.getItem('simuladoP1_hist')||'[]');
  hist.push({ts:Date.now(),correct,total:totalObj,pct,secs:state.secs});
  localStorage.setItem('simuladoP1_hist', JSON.stringify(hist));
  drawChart();
  window.scrollTo({top:0, behavior:'smooth'});
}

function drawChart(){
  const ctx = document.getElementById('chart').getContext('2d');
  const hist = JSON.parse(localStorage.getItem('simuladoP1_hist')||'[]');
  ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height);
  const W=ctx.canvas.width, H=ctx.canvas.height;
  ctx.fillStyle='rgba(255,255,255,0.06)'; ctx.fillRect(0,0,W,H);
  ctx.strokeStyle='rgba(255,255,255,0.15)'; ctx.lineWidth=1;
  ctx.beginPath(); ctx.moveTo(40,10); ctx.lineTo(40,H-30); ctx.lineTo(W-10,H-30); ctx.stroke();
  ctx.fillStyle='rgba(226,232,240,.85)'; ctx.font='12px system-ui';
  ctx.fillText('100%',6,18); ctx.fillText('50%',12,H/2); ctx.fillText('0%',18,H-35);
  ctx.strokeStyle='rgba(255,255,255,0.08)';
  ctx.beginPath(); ctx.moveTo(40,H/2); ctx.lineTo(W-10,H/2); ctx.moveTo(40,10); ctx.lineTo(W-10,10); ctx.stroke();
  if(hist.length===0){ ctx.fillText('Sem hist√≥rico ainda.',60,H/2); return; }
  const maxBars=Math.min(hist.length,30), data=hist.slice(-maxBars);
  const gap=8, chartW=(W-60), barW=Math.max(10, Math.floor((chartW-gap*(maxBars-1))/maxBars));
  let x=40;
  data.forEach(p=>{
    const h=Math.max(2, Math.round((p.pct/100)*(H-50)));
    const y=(H-30)-h;
    const grd=ctx.createLinearGradient(0,y,0,y+h);
    grd.addColorStop(0,'#22d3ee'); grd.addColorStop(1,'#a78bfa');
    ctx.fillStyle=grd; ctx.fillRect(x,y,barW,h);
    if(maxBars<=15){ ctx.fillStyle='rgba(148,163,184,.8)'; ctx.fillText(`${p.pct}%`,x+2,y-4); }
    x+=barW+gap;
  });
}

function shuffleArray(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } }

/* ============================================================
   EVENTOS
   ============================================================ */
els.btnStart.addEventListener('click',()=>{
  if(!quizData.length){ alert('Sem quest√µes.'); return; }
  state.order=[...Array(quizData.length).keys()];
  if(els.shuffle.checked) shuffleArray(state.order);
  state.started=true; startTimer(); state.idx=0; renderQuestion();
});
els.btnNext.addEventListener('click',()=>next());
els.btnPrev.addEventListener('click',()=>prev());
els.btnReview.addEventListener('click',()=>review());
els.btnFinish.addEventListener('click',()=>finish());
els.toggleJust.addEventListener('change',()=>renderQuestion());

document.getElementById('btnDownload').addEventListener('click',()=>{
  const hist=localStorage.getItem('simuladoP1_hist')||'[]';
  const blob=new Blob([hist],{type:'application/json'});
  const a=document.createElement('a'); a.href=URL.createObjectURL(blob);
  a.download=`relatorio_simulado_anatomia_p1_${new Date().toISOString().slice(0,10)}.json`; a.click();
});
document.getElementById('btnResetStats').addEventListener('click',()=>{
  if(confirm('Apagar hist√≥rico salvo neste navegador?')){
    localStorage.removeItem('simuladoP1_hist'); drawChart();
  }
});

/* start */
setProgress(); drawChart();
</script>
</body>
</html>
